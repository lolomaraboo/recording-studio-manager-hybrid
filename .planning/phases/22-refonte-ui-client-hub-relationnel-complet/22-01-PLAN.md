---
phase: 22-refonte-ui-client-hub-relationnel-complet
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/client/src/components/ClientFormWizard.tsx
  - packages/client/src/pages/ClientCreate.tsx
autonomous: true

must_haves:
  truths:
    - User can navigate freely between 3 wizard steps
    - Stepper is always clickable (no blocking validation)
    - Step 1 shows base fields (name, email, type, phone, address)
    - Step 2 shows enriched vCard fields (contacts arrays, custom fields)
    - Step 3 shows 22 music profile fields
    - Form can be submitted from any step
  artifacts:
    - path: packages/client/src/components/ClientFormWizard.tsx
      provides: Reusable 3-step wizard component
      min_lines: 200
      exports: ["ClientFormWizard"]
    - path: packages/client/src/pages/ClientCreate.tsx
      provides: Client creation page using wizard
      min_lines: 50
      contains: "<ClientFormWizard"
  key_links:
    - from: packages/client/src/pages/ClientCreate.tsx
      to: packages/client/src/components/ClientFormWizard.tsx
      via: "import and render"
      pattern: "import.*ClientFormWizard.*from"
    - from: packages/client/src/components/ClientFormWizard.tsx
      to: "@/lib/trpc"
      via: "clients.create mutation"
      pattern: "trpc\\.clients\\.create"
---

<objective>
Create reusable ClientFormWizard component with 3-step navigation for client creation and modification.

Purpose: Organize ~50 client fields into logical sections with flexible navigation
Output: Wizard component that works for both creation and edit modes
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-refonte-ui-client-hub-relationnel-complet/22-CONTEXT.md

# Existing client creation
@packages/client/src/pages/ClientCreate.tsx
</context>

<tasks>

<task type="auto">
  <name>Create ClientFormWizard component</name>
  <files>packages/client/src/components/ClientFormWizard.tsx</files>
  <action>
    Create new component ClientFormWizard with:

    **Props:**
    - mode: "create" | "edit"
    - initialData?: Partial client data (for edit mode)
    - onSubmit: (data) => void
    - onCancel: () => void

    **3 Steps with Stepper:**
    - Use shadcn/ui Tabs component for step navigation
    - TabsList shows: [1. Base] [2. Enrichi] [3. Musique]
    - ALL tabs always clickable (no disabled state)
    - Navigation persists form data (useState for formData)

    **Step 1 - Base:**
    Fields: name, type (individual/company), firstName, lastName, middleName, prefix, suffix, artistName, email, phone, address (single field OR street/city/postalCode/region/country), birthday, gender

    **Step 2 - Enrichi:**
    Arrays with Add/Remove buttons:
    - phones: Array<{type, number}>
    - emails: Array<{type, email}>
    - websites: Array<{type, url}>
    - customFields: Array<{label, type, value}>
    Avatar/logo upload buttons

    **Step 3 - Musique (22 fields):**
    Import MusicProfileSection component (already exists from Phase 18.4)
    Pass formData + onChange handlers

    **Submit Button:**
    - Visible on ALL steps (not just last step)
    - Calls onSubmit(formData) with complete data
    - Validation: Only name required (minimal validation)

    Use existing shadcn components: Tabs, TabsList, TabsTrigger, TabsContent, Input, Label, Button, Select
  </action>
  <verify>
    Component compiles without TypeScript errors
    `pnpm --filter client check` passes
  </verify>
  <done>
    ClientFormWizard component exists with 3 steps, stepper navigation, submit button on all steps
  </done>
</task>

<task type="auto">
  <name>Refactor ClientCreate to use wizard</name>
  <files>packages/client/src/pages/ClientCreate.tsx</files>
  <action>
    Replace existing 4-tab form with ClientFormWizard component:

    1. Keep existing imports: trpc, toast, navigate
    2. Remove all form state management (handled by wizard)
    3. Remove tab state (handled by wizard)
    4. Render: `<ClientFormWizard mode="create" onSubmit={handleSubmit} onCancel={() => navigate("/clients")} />`
    5. handleSubmit function calls existing createMutation.mutate()

    Preserve:
    - Breadcrumb navigation (ArrowLeft to /clients)
    - Page title "Cr√©er un client"
    - Error handling via toast
    - Success redirect to client detail page
  </action>
  <verify>
    Page loads without errors
    Form submission creates client via tRPC
    Navigation between steps works
    `pnpm --filter client dev` runs without errors
  </verify>
  <done>
    ClientCreate page uses ClientFormWizard, form submission works, navigation to client detail after success
  </done>
</task>

<task type="auto">
  <name>Build and validate</name>
  <files>packages/client/</files>
  <action>
    Run production build to catch any issues:

    ```bash
    pnpm --filter client check
    pnpm --filter client build
    ```

    Fix any TypeScript errors or build failures.
    Ensure MusicProfileSection integration works (component exists from Phase 18.4).
  </action>
  <verify>
    `pnpm --filter client check` exits 0
    `pnpm --filter client build` succeeds
    No TypeScript errors
  </verify>
  <done>
    Client package builds successfully with wizard component integrated
  </done>
</task>

</tasks>

<verification>
Overall checks:
- ClientFormWizard component renders 3 steps
- Stepper tabs are always clickable (free navigation)
- Submit button visible on all steps
- ClientCreate page uses wizard
- Form submission creates client successfully
- TypeScript compilation passes
</verification>

<success_criteria>
- User can click between steps freely without blocking validation
- Step 1 shows base fields (name, email, type, phone, address)
- Step 2 shows enriched vCard arrays (phones, emails, websites, customFields)
- Step 3 shows music profile fields (22 fields via MusicProfileSection)
- Submit button works from any step
- ClientCreate page uses wizard component
- Zero TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/22-refonte-ui-client-hub-relationnel-complet/22-01-SUMMARY.md`
</output>
