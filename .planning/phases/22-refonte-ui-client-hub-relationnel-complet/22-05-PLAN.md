---
phase: 22-refonte-ui-client-hub-relationnel-complet
plan: 05
type: execute
wave: 2
depends_on: ["22-02"]
files_modified:
  - packages/client/src/components/tabs/SessionsTab.tsx
  - packages/client/src/components/ClientDetailTabs.tsx
autonomous: true

must_haves:
  truths:
    - Sessions tab shows 4 view modes: Table, Cards, Timeline, Kanban
    - Toggle buttons switch between modes
    - Default mode is Table (existing implementation)
    - Timeline shows chronological view (past/upcoming)
    - Kanban shows columns by status
    - Empty state shows illustration + CTA button
  artifacts:
    - path: packages/client/src/components/tabs/SessionsTab.tsx
      provides: Sessions tab with 4 view modes
      min_lines: 200
      exports: ["SessionsTab"]
  key_links:
    - from: packages/client/src/components/tabs/SessionsTab.tsx
      to: "@/lib/trpc"
      via: "sessions.list query"
      pattern: "trpc\\.sessions\\.list"
---

<objective>
Refactor Sessions tab with 4 display modes (Table, Cards, Timeline, Kanban).

Purpose: Enhance sessions viewing with multiple layout options
Output: Sessions tab with view mode toggle, reusing existing sessions data query
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/22-refonte-ui-client-hub-relationnel-complet/22-CONTEXT.md
@packages/client/src/pages/ClientDetail.tsx
</context>

<tasks>

<task type="auto">
  <name>Create SessionsTab component with 4 view modes</name>
  <files>packages/client/src/components/tabs/SessionsTab.tsx</files>
  <action>
    Extract existing sessions table from ClientDetail and enhance with 4 modes:

    **Props:**
    - clientId: number
    - sessions: Session[] (passed from parent, already filtered by client)
    - rooms: Room[] (for room name display)

    **State:**
    - viewMode: "table" | "cards" | "timeline" | "kanban" (default: "table")
    - Use localStorage for persistence: `localStorage.getItem("sessions-view-mode")`

    **View Mode Toggle:**
    Button group with 4 buttons (lucide icons: Table2, LayoutGrid, CalendarDays, Trello)

    **Mode 1 - Table (default, existing implementation):**
    Keep current table structure:
    Columns: Session | Salle | Date | Statut | Actions

    **Mode 2 - Cards compactes:**
    Grid layout (2-3 cols) with session cards:
    - Title (h3)
    - Room name
    - Date/heure (formatted)
    - Status badge (colored: Programmée/En cours/Terminée/Annulée)
    - Duration
    - Click → navigate to `/sessions/${id}`

    **Mode 3 - Timeline/Calendar:**
    Chronological view with 2 sections:
    - Past sessions (sorted desc by date)
    - Upcoming sessions (sorted asc by date)
    Timeline visualization with date markers

    **Mode 4 - Kanban par statut:**
    Columns by status: [Programmée] [En cours] [Terminée] [Annulée]
    Cards grouped by session.status
    Drag & drop NOT required (nice-to-have for future)

    **Empty State:**
    If no sessions:
    ```tsx
    <div className="py-6 text-center">
      <Calendar className="h-12 w-12 mx-auto text-muted-foreground" />
      <p>Aucune session pour ce client</p>
      <Button onClick={() => navigate(`/sessions/new?clientId=${clientId}`)}>
        Créer une session
      </Button>
    </div>
    ```

    Sessions already filtered by clientId in parent component (ClientDetail.tsx).
  </action>
  <verify>
    Component renders 4 view modes
    Toggle buttons switch modes correctly
    localStorage persists view mode selection
    Empty state shows CTA button
    `pnpm --filter client check` passes
  </verify>
  <done>
    SessionsTab component exists with 4 modes, toggle, empty state, navigation to session detail
  </done>
</task>

<task type="auto">
  <name>Integrate SessionsTab into ClientDetailTabs</name>
  <files>packages/client/src/components/ClientDetailTabs.tsx</files>
  <action>
    Replace existing sessions table with SessionsTab component:

    ```tsx
    import { SessionsTab } from "./tabs/SessionsTab";

    // In TabsContent for "sessions":
    <TabsContent value="sessions">
      <SessionsTab
        clientId={clientId}
        sessions={clientSessions}
        rooms={rooms}
      />
    </TabsContent>
    ```

    Pass already-filtered sessions data from parent (ClientDetail.tsx uses useMemo to filter sessions by clientId).
  </action>
  <verify>
    Sessions tab shows SessionsTab component
    View modes toggle correctly
    Existing table mode works exactly as before
    New Cards/Timeline/Kanban modes render correctly
    No console errors
    `pnpm --filter client dev` runs without errors
  </verify>
  <done>
    ClientDetailTabs renders functional SessionsTab component on sessions tab with 4 view modes
  </done>
</task>

</tasks>

<verification>
Overall checks:
- Sessions tab shows 4 view mode buttons
- Table mode (default) displays existing sessions table
- Cards mode shows session cards with room, date, status
- Timeline mode shows past/upcoming sections
- Kanban mode shows columns by status (Programmée/En cours/Terminée/Annulée)
- Empty state shows calendar icon + "Créer une session" button
- View mode persisted in localStorage
- Clicking session navigates to session detail
- TypeScript compilation passes
</verification>

<success_criteria>
- SessionsTab component has 4 view modes (Table, Cards, Timeline, Kanban)
- Toggle buttons switch between modes, selection persisted in localStorage
- Table mode preserves existing functionality exactly
- Cards/Timeline/Kanban modes display sessions correctly
- Empty state shows illustration + CTA button that navigates to session creation
- Clicking session navigates to /sessions/{id}
- Zero TypeScript errors
</success_criteria>

<output>
After completion, create `.planning/phases/22-refonte-ui-client-hub-relationnel-complet/22-05-SUMMARY.md`
</output>
