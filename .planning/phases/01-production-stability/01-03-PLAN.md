---
phase: 01-production-stability
plan: 3
type: execute
---

<objective>
Validate production deployment works end-to-end across all critical user flows.

Purpose: CORS fixed and monitoring active, but need to verify full production stack works as expected before proceeding to new features.
Output: Production validated with test tenant, critical flows tested, confidence in stability baseline established.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-production-stability/01-01-SUMMARY.md
@.planning/phases/01-production-stability/01-02-SUMMARY.md

**Production environment:**
- Domain: *.recording-studio-manager.com
- Main app: https://app.recording-studio-manager.com
- Demo studio: https://studio-demo.recording-studio-manager.com (if exists)
- VPS: 31.220.104.244

**Critical flows to validate (from PROJECT.md success criteria):**
- Signup → Dashboard (new tenant creation)
- Booking → Payment (Stripe integration)
- Project → Track upload (Phase 5 feature)
- Client Portal access
- Authentication multi-tenant isolation

**Infrastructure components:**
- Frontend: React app (rsm-client container)
- Backend: Express + tRPC (rsm-server container)
- Database: PostgreSQL multi-tenant (rsm-postgres container)
- Cache: Redis sessions (rsm-redis container)
- Payment: Stripe integration
- AI: Anthropic chatbot (37 actions)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create test tenant account</name>
  <files>Production database, test account</files>
  <action>
    1. Visit production signup: https://app.recording-studio-manager.com/signup
    2. Create test account:
       - Studio Name: "Test Studio Validation"
       - Email: test-validation@recording-studio-manager.com (or your test email)
       - Password: Strong password (save to .env.test for reference)
    3. Verify tenant database created (check PostgreSQL has tenant_N database)
    4. Verify auto-provisioning worked (from auth.ts changes in Plan 01-01)
    5. Document test credentials securely for future validation
  </action>
  <verify>
    - Test account created successfully
    - Redirected to dashboard after signup
    - No errors in browser console
    - Sentry shows no errors during signup flow
  </verify>
  <done>Test tenant created in production, auto-provisioning successful, credentials documented</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Test tenant account in production</what-built>
  <how-to-verify>
    1. Login with test account: https://app.recording-studio-manager.com/login
    2. Verify dashboard loads without errors
    3. Check browser DevTools > Network:
       - All API calls return 200 (no CORS errors)
       - Authentication cookie set correctly
    4. Check browser DevTools > Console:
       - No error messages (red text)
       - App loads without warnings about critical issues
    5. Navigate to main sections:
       - Dashboard → Check loads
       - Booking → Check loads
       - Clients → Check loads
       - Projects → Check loads (Phase 5 feature)
    6. Verify UI renders correctly (no broken layouts, images load)
  </how-to-verify>
  <resume-signal>Type "approved" if all sections load correctly, or describe which section has errors</resume-signal>
</task>

<task type="auto">
  <name>Task 2: Test booking flow end-to-end</name>
  <files>Production booking system</files>
  <action>
    Using the test tenant account:
    1. Navigate to Bookings section
    2. Create new booking:
       - Select a room (create room first if needed)
       - Choose date/time slot
       - Assign to test client (create client first if needed)
       - Add session details (duration, type)
    3. Save booking
    4. Verify booking appears in calendar/list
    5. Try editing booking (update time, add notes)
    6. Verify changes persist after page refresh
    7. Check database: Query tenant_N database to verify booking record exists
  </action>
  <verify>
    - Booking created successfully
    - No errors in console or Sentry
    - Booking visible in UI after refresh
    - Database record exists in tenant_N.bookings table
  </verify>
  <done>Booking flow validated - create, edit, persist all working in production</done>
</task>

<task type="auto">
  <name>Task 3: Test Stripe payment integration</name>
  <files>Production Stripe integration</files>
  <action>
    1. Navigate to payment/invoicing section (if available in UI)
    2. Attempt to create test payment:
       - Use Stripe test card: 4242 4242 4242 4242
       - Expiry: Any future date (e.g., 12/30)
       - CVC: Any 3 digits (e.g., 123)
    3. Verify payment intent created in Stripe dashboard
    4. Check webhook delivery (if webhooks configured in Phase 4.2)
    5. Verify payment status updates in app
    6. Alternative: If no payment UI yet, test Stripe connection via API health check or server logs showing Stripe SDK initialized
  </action>
  <verify>
    - Stripe test payment succeeds (or connection verified)
    - No errors in Sentry related to Stripe
    - Stripe dashboard shows test payment/activity
    - Webhook events received if configured
  </verify>
  <done>Stripe integration validated - payments processing or connection confirmed active</done>
</task>

<task type="auto">
  <name>Task 4: Test Projects Management feature (Phase 5)</name>
  <files>Production Projects Management</files>
  <action>
    1. Navigate to Projects section
    2. Create new project:
       - Project name: "Test Album Validation"
       - Assign to test client
       - Add project details (genre, deadline, etc.)
    3. Within project, test track upload:
       - Upload small audio file (test-track.mp3)
       - Verify file appears in project
       - Test waveform player (if implemented - Item 11 may be this)
       - Add comments to track
       - Test versioning (upload second version if feature exists)
    4. Verify project data persists after refresh
    5. Check file storage (Cloudinary dashboard if using, or local storage)
  </action>
  <verify>
    - Project created successfully
    - Track upload works (file visible in UI)
    - Waveform player loads (if implemented)
    - No errors in console or Sentry during project operations
    - Files stored correctly (Cloudinary or local)
  </verify>
  <done>Projects Management validated - create project, upload tracks, view/play audio all working</done>
</task>

<task type="auto">
  <name>Task 5: Test Client Portal access</name>
  <files>Production Client Portal</files>
  <action>
    1. As studio owner (test account), create client user if needed
    2. Get client portal URL (likely client-specific subdomain or shared portal)
    3. Login as client (may need separate client credentials)
    4. Verify client can view:
       - Their bookings
       - Their projects
       - Make payments (Stripe integration)
    5. Test client cannot access:
       - Other clients' data (tenant isolation)
       - Studio admin features
    6. Verify multi-tenant isolation (client sees only their studio's data)
  </action>
  <verify>
    - Client portal accessible
    - Client can view own data (bookings, projects)
    - Client cannot see other clients' data
    - No authorization errors in Sentry
    - Multi-tenant isolation working
  </verify>
  <done>Client Portal validated - access control working, tenant isolation confirmed</done>
</task>

<task type="auto">
  <name>Task 6: Test AI Chatbot (if critical)</name>
  <files>Production AI Assistant</files>
  <action>
    1. Locate AI chatbot in UI (likely chatbot icon or /chat route)
    2. Send test query: "What bookings do I have this week?"
    3. Verify chatbot responds (Anthropic API connection working)
    4. Test action execution (e.g., "Create a booking for tomorrow at 2pm")
    5. Check Sentry for Anthropic API errors
    6. If chatbot not critical for v1.0, mark as optional and skip detailed testing
  </action>
  <verify>
    - Chatbot interface loads
    - Anthropic API responds to queries
    - No API errors in Sentry
    - Actions execute if tested (booking creation, etc.)
  </verify>
  <done>AI Chatbot validated - Anthropic integration working, basic actions functional (or marked optional if not critical)</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Full production stack validated across all critical flows</what-built>
  <how-to-verify>
    Review all tested flows:
    1. Signup/Login → Dashboard (Task 1-2)
    2. Booking creation → Calendar (Task 2)
    3. Payment processing → Stripe (Task 3)
    4. Project creation → Track upload (Task 4)
    5. Client Portal → Tenant isolation (Task 5)
    6. AI Chatbot → Anthropic API (Task 6)

    Confirm:
    - All critical flows work without errors
    - No CORS issues in any flow
    - Sentry captured no critical errors during testing
    - UptimeRobot shows stable uptime
    - Production feels stable and ready for Phase 2 work

    Note any issues found that need addressing before proceeding.
  </how-to-verify>
  <resume-signal>Type "production validated" if all flows working, or list any issues that need fixing before Phase 2</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] Test tenant created successfully in production
- [ ] Booking flow works (create, edit, persist)
- [ ] Stripe integration active (payments or connection verified)
- [ ] Projects Management works (create project, upload tracks)
- [ ] Client Portal accessible with proper isolation
- [ ] AI Chatbot functional (or marked optional)
- [ ] No critical errors in Sentry from validation testing
- [ ] UptimeRobot shows stable uptime during validation
</verification>

<success_criteria>

- Production stack validated across all critical user flows
- Test tenant demonstrates full app functionality
- No blocking bugs discovered during validation
- CORS fix confirmed working in all flows
- Monitoring capturing errors and uptime correctly
- Phase 1 complete - stable production foundation established
- Ready to proceed to Phase 2 (Complete Phase 5 - Projects Management)
</success_criteria>

<output>
After completion, create `.planning/phases/01-production-stability/01-03-SUMMARY.md`:

# Phase 1 Plan 3: Validate Production Summary

**Production stability confirmed - all critical flows tested and working**

## Accomplishments

- Created test tenant in production to validate multi-tenant provisioning
- Validated booking flow (create, edit, persist)
- Confirmed Stripe integration active
- Tested Projects Management (Phase 5 feature - create project, upload tracks)
- Verified Client Portal access and tenant isolation
- Tested AI Chatbot Anthropic integration
- No critical errors discovered during comprehensive validation
- UptimeRobot confirmed stable uptime throughout testing

## Files Created/Modified

- Test account credentials documented (test-validation@recording-studio-manager.com)
- Production database: tenant_N created for test studio
- Test data: bookings, projects, tracks uploaded for validation

## Decisions Made

- Test tenant kept active for future validation (not deleted)
- AI Chatbot marked [critical/optional] based on testing priority
- Identified [any issues] that need addressing in future phases

## Issues Encountered

[Document any bugs/issues found during validation]
[Note: Minor issues can be deferred to ISSUES.md, blocking issues must be fixed before Phase 2]

## Next Phase Readiness

**Phase 1 Complete** ✓

Production stability established:
- ✓ CORS HTTPS blocker fixed
- ✓ Pending code committed (auth.ts, test cleanup)
- ✓ Basic monitoring active (health checks, Sentry, UptimeRobot)
- ✓ Production validated end-to-end

Ready to proceed to **Phase 2: Complete Phase 5** (finish Projects Management Item 11, integration testing)

Stable foundation in place - can now focus on completing feature work and preparing for commercial launch.
</output>
