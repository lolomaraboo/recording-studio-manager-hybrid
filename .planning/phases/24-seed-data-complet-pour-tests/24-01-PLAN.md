---
phase: 24-seed-data-complet-pour-tests
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - packages/database/scripts/init/seed-realistic-data.ts
autonomous: true

must_haves:
  truths:
    - "Individual clients have populated genres arrays (1-3 genres each)"
    - "Individual clients have populated instruments arrays (1-4 instruments each)"
    - "At least 50% of clients have Spotify URLs populated"
    - "Record label, distributor, manager fields populated for 30%+ clients"
    - "Biography and notable works populated for 40%+ clients"
    - "Career info (yearsActive, awards) populated for relevant artist types"
  artifacts:
    - path: "packages/database/scripts/init/seed-realistic-data.ts"
      provides: "Enhanced seed script with music profile field generation"
      min_lines: 750
      contains: "genres: sql.json(faker.helpers.arrayElements"
    - path: "packages/database/scripts/init/seed-realistic-data.ts"
      provides: "Streaming platform URL generation"
      contains: "spotifyUrl:"
    - path: "packages/database/scripts/init/seed-realistic-data.ts"
      provides: "Industry info generation"
      contains: "recordLabel:"
  key_links:
    - from: "faker.js library"
      to: "clients.genres field"
      via: "faker.helpers.arrayElements(GENRES, {min: 1, max: 3})"
      pattern: "genres.*arrayElements.*GENRES"
    - from: "faker.js library"
      to: "clients streaming URLs"
      via: "conditional URL generation with faker.internet.url()"
      pattern: "spotifyUrl.*faker.*url"
    - from: "GENRES constant"
      to: "music profile fields"
      via: "faker.helpers.arrayElement selection"
      pattern: "GENRES.*=.*\\[.*Rock.*Hip-Hop"
---

<objective>
Enhance seed-realistic-data.ts to populate all 22 Phase 18.4 music profile fields with realistic data.

Purpose: Enable comprehensive testing of music profile features (search filters, streaming URL displays, industry info rendering, genre distribution stats).

Output: Updated seed script that generates individual clients with complete music profiles including genres, instruments, streaming platforms, industry contacts, and career information.
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

# Current seed script
@packages/database/scripts/init/seed-realistic-data.ts

# Music profile schema (Phase 18.4)
@packages/database/src/tenant/schema.ts
</context>

<tasks>

<task type="auto">
  <name>Add music profile constants and genre/instrument generation</name>
  <files>packages/database/scripts/init/seed-realistic-data.ts</files>
  <action>
Add realistic music data constants after existing GENRES array (around line 29):

```typescript
const INSTRUMENTS = [
  'Vocals', 'Guitar', 'Bass', 'Drums', 'Keyboard', 'Piano',
  'Synthesizer', 'Saxophone', 'Trumpet', 'Violin', 'Cello',
  'Flute', 'Clarinet', 'Harmonica', 'Accordion', 'Banjo',
  'Ukulele', 'Mandolin', 'Production', 'DJ Equipment', 'Beatmaking'
];

const RECORD_LABELS = [
  'Universal Music', 'Sony Music', 'Warner Music', 'Indie Records',
  'Blue Note', 'Def Jam', 'Atlantic Records', 'Capitol Records',
  'Columbia Records', 'Island Records', 'Self-Released', null // 50% have labels
];

const DISTRIBUTORS = [
  'DistroKid', 'CD Baby', 'TuneCore', 'AWAL', 'The Orchard',
  'Believe Digital', 'Ditto Music', 'Self-Distributed', null
];

const PERFORMANCE_RIGHTS = ['SACEM', 'SOCAN', 'BMI', 'ASCAP', 'PRS', null];
```

In individual clients loop (around line 54-88), add music profile field generation BEFORE the INSERT:

```typescript
// Generate music profile fields (Phase 18.4)
const genreCount = faker.number.int({ min: 1, max: 3 });
const genres = faker.helpers.arrayElements(GENRES, genreCount);

const instrumentCount = faker.number.int({ min: 1, max: 4 });
const instruments = faker.helpers.arrayElements(INSTRUMENTS, instrumentCount);

// Streaming platforms (50% have profiles)
const hasStreamingProfile = faker.datatype.boolean();
const spotifyUrl = hasStreamingProfile
  ? `https://open.spotify.com/artist/${faker.string.alphanumeric(22)}`
  : null;
const appleMusicUrl = hasStreamingProfile && faker.datatype.boolean({ probability: 0.7 })
  ? `https://music.apple.com/artist/${faker.string.alphanumeric(10)}`
  : null;
const youtubeUrl = faker.datatype.boolean({ probability: 0.6 })
  ? `https://youtube.com/@${faker.internet.userName()}`
  : null;
const soundcloudUrl = faker.datatype.boolean({ probability: 0.4 })
  ? `https://soundcloud.com/${faker.internet.userName()}`
  : null;
const bandcampUrl = faker.datatype.boolean({ probability: 0.3 })
  ? `https://${faker.internet.userName()}.bandcamp.com`
  : null;

// Industry info (30-40% have representation)
const hasRepresentation = faker.datatype.boolean({ probability: 0.35 });
const recordLabel = hasRepresentation ? faker.helpers.arrayElement(RECORD_LABELS) : null;
const distributor = faker.helpers.arrayElement(DISTRIBUTORS);
const managerContact = hasRepresentation
  ? `${faker.person.fullName()} <${faker.internet.email()}>`
  : null;
const publisher = hasRepresentation && faker.datatype.boolean({ probability: 0.5 })
  ? faker.company.name()
  : null;
const performanceRightsSociety = faker.helpers.arrayElement(PERFORMANCE_RIGHTS);

// Career info
const startYear = faker.number.int({ min: 2010, max: 2020 });
const yearsActive = `${startYear}-present`;
const notableWorks = faker.datatype.boolean({ probability: 0.4 })
  ? faker.helpers.arrayElements([
      `${faker.music.songName()} (${faker.number.int({ min: 2015, max: 2024 })})`,
      `${faker.music.songName()} (${faker.number.int({ min: 2015, max: 2024 })})`,
    ], faker.number.int({ min: 1, max: 2 })).join(', ')
  : null;
const awardsRecognition = faker.datatype.boolean({ probability: 0.2 })
  ? faker.helpers.arrayElement([
      'Victoires de la Musique 2022',
      'SACEM Award 2021',
      'Prix Constantin Nominee',
      'Regional Music Award Winner'
    ])
  : null;
const biography = faker.datatype.boolean({ probability: 0.4 })
  ? faker.lorem.paragraph({ min: 2, max: 4 })
  : null;
```

Update the INSERT statement (around line 63-85) to include new fields:

```typescript
const [client] = await sql`
  INSERT INTO clients (
    name, first_name, last_name, email, phone, type, city,
    artist_name, phones, emails, avatar_url,
    genres, instruments,
    spotify_url, apple_music_url, youtube_url, soundcloud_url, bandcamp_url,
    record_label, distributor, manager_contact, publisher, performance_rights_society,
    years_active, notable_works, awards_recognition, biography,
    created_at, updated_at
  )
  VALUES (
    ${`${firstName} ${lastName}`},
    ${firstName},
    ${lastName},
    ${email},
    ${phone},
    'individual',
    ${faker.location.city()},
    ${artistName},
    ${sql.json([{ type: 'mobile', number: phone }])},
    ${sql.json([{ type: 'work', email }])},
    ${`https://i.pravatar.cc/150?img=${i + 1}`},
    ${sql.json(genres)},
    ${sql.json(instruments)},
    ${spotifyUrl},
    ${appleMusicUrl},
    ${youtubeUrl},
    ${soundcloudUrl},
    ${bandcampUrl},
    ${recordLabel},
    ${distributor},
    ${managerContact},
    ${publisher},
    ${performanceRightsSociety},
    ${yearsActive},
    ${notableWorks},
    ${awardsRecognition},
    ${biography},
    NOW(),
    NOW()
  )
  RETURNING id, name
`;
```

Rationale: Populates all 22 music profile fields with realistic distributions matching real-world artist data (not all artists have Spotify, not all have labels, etc.).
  </action>
  <verify>
Run script locally and check clients table:

```bash
DATABASE_URL="postgresql://postgres@localhost:5432/tenant_24" \
  pnpm exec tsx packages/database/scripts/init/seed-realistic-data.ts

# Verify music profiles populated
psql postgresql://postgres@localhost:5432/tenant_24 -c \
  "SELECT name, array_length(genres, 1) as genre_count,
   array_length(instruments, 1) as instrument_count,
   spotify_url IS NOT NULL as has_spotify,
   record_label IS NOT NULL as has_label
   FROM clients WHERE type = 'individual' LIMIT 5;"
```

Expected: 8 individual clients with genres arrays (1-3 items), instruments arrays (1-4 items), varied streaming URLs.
  </verify>
  <done>
- All 8 individual clients have genres array populated (1-3 genres each)
- All 8 individual clients have instruments array populated (1-4 instruments each)
- At least 4 clients (50%+) have Spotify URLs
- At least 2 clients (25%+) have record labels
- At least 3 clients (40%+) have biography text
- Script runs successfully with zero PostgreSQL errors
  </done>
</task>

</tasks>

<verification>
**Full seed validation:**

```bash
# Create fresh tenant for testing
createdb tenant_24

# Apply tenant migrations
DATABASE_URL="postgresql://postgres@localhost:5432/tenant_24" \
  pnpm db:migrate

# Run enhanced seed script
DATABASE_URL="postgresql://postgres@localhost:5432/tenant_24" \
  pnpm exec tsx packages/database/scripts/init/seed-realistic-data.ts

# Verify music profile coverage
psql postgresql://postgres@localhost:5432/tenant_24 -c \
  "SELECT
    COUNT(*) as total_clients,
    COUNT(CASE WHEN genres IS NOT NULL THEN 1 END) as with_genres,
    COUNT(CASE WHEN instruments IS NOT NULL THEN 1 END) as with_instruments,
    COUNT(CASE WHEN spotify_url IS NOT NULL THEN 1 END) as with_spotify,
    COUNT(CASE WHEN record_label IS NOT NULL THEN 1 END) as with_label,
    COUNT(CASE WHEN biography IS NOT NULL THEN 1 END) as with_bio
   FROM clients WHERE type = 'individual';"
```

**Expected output:**
```
 total_clients | with_genres | with_instruments | with_spotify | with_label | with_bio
---------------+-------------+------------------+--------------+------------+----------
             8 |           8 |                8 |            4 |          3 |        3
```

**Test search filters (Phase 18.4-03 feature):**

```sql
-- Genre filtering (should find clients)
SELECT name, genres FROM clients
WHERE genres @> '["Rock"]'::jsonb LIMIT 3;

-- Instrument filtering (should find clients)
SELECT name, instruments FROM clients
WHERE instruments @> '["Guitar"]'::jsonb LIMIT 3;
```
</verification>

<success_criteria>
- [x] Enhanced seed script runs successfully on fresh tenant database
- [x] All 8 individual clients have genres populated (JSONB arrays, 1-3 items)
- [x] All 8 individual clients have instruments populated (JSONB arrays, 1-4 items)
- [x] At least 50% of clients have Spotify URLs (4+ clients)
- [x] At least 30% of clients have record labels (2+ clients)
- [x] At least 40% of clients have biography text (3+ clients)
- [x] Genre filtering works: `genres @> '["Rock"]'` returns results
- [x] Instrument filtering works: `instruments @> '["Guitar"]'` returns results
- [x] Zero PostgreSQL errors during seed execution
- [x] Script maintains existing functionality (rooms, projects, sessions still created)
</success_criteria>

<output>
After completion, create `.planning/phases/24-seed-data-complet-pour-tests/24-01-SUMMARY.md`
</output>
