---
phase: 28-harmonisation-ui-talents
plan: 05
type: execute
wave: 5
depends_on: [28-04]
files_modified:
  - packages/client/src/components/TalentEditForm.tsx (new file)
  - packages/client/src/components/TalentDetailTabs.tsx
  - packages/client/src/pages/TalentCreate.tsx
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "Edit mode uses accordion pattern like ClientEditForm"
    - "Wizard pattern eliminated from talent creation/editing"
    - "Accordions open by default for immediate field access"
    - "Form structure matches talent context (no client-specific fields)"
  artifacts:
    - path: "packages/client/src/components/TalentEditForm.tsx"
      provides: "Accordion-based edit form for talents"
      min_lines: 400
      exports: ["TalentEditForm"]
    - path: "packages/client/src/pages/TalentCreate.tsx"
      provides: "Simplified creation page using TalentEditForm"
      min_lines: 150
      contains: "TalentEditForm"
  key_links:
    - from: "TalentDetailTabs"
      to: "TalentEditForm"
      via: "conditional render in edit mode"
      pattern: "isEditing.*TalentEditForm"
    - from: "TalentCreate.tsx"
      to: "TalentEditForm"
      via: "reusable component for creation"
      pattern: "TalentEditForm"
---

<objective>
Replace wizard pattern with accordion-based TalentEditForm matching ClientEditForm structure from Phase 26.

Purpose: Complete Phase 28 harmonization by eliminating wizard friction and providing consistent edit UX
Output: TalentEditForm component and refactored TalentCreate page
</objective>

<execution_context>
@~/.claude/get-shit-done/workflows/execute-plan.md
@~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/28-harmonisation-ui-talents/28-CONTEXT.md
@.planning/phases/28-harmonisation-ui-talents/28-01-SUMMARY.md
@.planning/phases/28-harmonisation-ui-talents/28-02-SUMMARY.md
@.planning/phases/28-harmonisation-ui-talents/28-03-SUMMARY.md
@.planning/phases/28-harmonisation-ui-talents/28-04-SUMMARY.md (created by 28-04)

# Reference implementations (CLIENT patterns)
@packages/client/src/components/ClientEditForm.tsx (accordion pattern reference)

# Current talent implementation
@packages/client/src/pages/TalentCreate.tsx (wizard pattern - to be replaced)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create TalentEditForm component with accordions</name>
  <files>packages/client/src/components/TalentEditForm.tsx</files>
  <action>
**Pattern reference:** ClientEditForm.tsx (accordions, all open by default, organized sections)

**Create accordion-based edit form for talents:**

1. **Component structure (adapt from ClientEditForm):**
   ```typescript
   import { useState, useEffect } from "react";
   import { Button } from "@/components/ui/button";
   import { Card } from "@/components/ui/card";
   import {
     Accordion,
     AccordionContent,
     AccordionItem,
     AccordionTrigger,
   } from "@/components/ui/accordion";
   import {
     User,
     Mail,
     Music,
     Radio,
     FileText,
     Globe,
   } from "lucide-react";

   interface TalentEditFormProps {
     formData: any;
     setFormData: (data: any) => void;
   }

   export function TalentEditForm({
     formData,
     setFormData,
   }: TalentEditFormProps) {
     // State for open accordions (all open by default)
     const [openItems, setOpenItems] = useState<string[]>(() => {
       try {
         const saved = localStorage.getItem('talentEditAccordions');
         return saved ? JSON.parse(saved) : ["identite", "contact", "profil-musical", "streaming", "notes"];
       } catch {
         return ["identite", "contact", "profil-musical", "streaming", "notes"];
       }
     });

     // Save accordion state to localStorage
     useEffect(() => {
       try {
         localStorage.setItem('talentEditAccordions', JSON.stringify(openItems));
       } catch (error) {
         console.error('Failed to save accordion state:', error);
       }
     }, [openItems]);

     // Alt key handler to toggle all accordions
     const handleAccordionTriggerClick = (event: React.MouseEvent) => {
       if (event.altKey) {
         event.preventDefault();
         event.stopPropagation();

         const allAccordions = ["identite", "contact", "profil-musical", "streaming", "notes"];
         if (openItems.length < allAccordions.length) {
           setOpenItems(allAccordions);
         } else {
           setOpenItems([]);
         }
       }
     };

     return (
       <Accordion
         type="multiple"
         value={openItems}
         onValueChange={setOpenItems}
         className="space-y-2"
       >
         {/* Accordion 1: Identité */}
         {/* Accordion 2: Contact */}
         {/* Accordion 3: Profil Musical */}
         {/* Accordion 4: Plateformes Streaming */}
         {/* Accordion 5: Notes */}
       </Accordion>
     );
   }
   ```

2. **Accordion 1: Identité** (name, stageName, talentType)
   ```typescript
   <AccordionItem value="identite">
     <Card>
       <AccordionTrigger className="px-4 py-3 hover:no-underline" onClick={handleAccordionTriggerClick}>
         <h3 className="text-lg font-semibold flex items-center gap-2">
           <User className="h-5 w-5 text-primary" />
           Identité
         </h3>
       </AccordionTrigger>
       <AccordionContent>
         <div className="px-4 pb-3 space-y-3">
           {/* Type de talent (musician/actor) */}
           <div>
             <label className="text-sm font-medium">Type de talent</label>
             <div className="flex gap-2 mt-2">
               <Button
                 type="button"
                 variant={formData.talentType === "musician" ? "default" : "outline"}
                 onClick={() => setFormData({ ...formData, talentType: "musician" })}
                 className="flex-1"
               >
                 <Music className="h-4 w-4 mr-2" />
                 Musicien
               </Button>
               <Button
                 type="button"
                 variant={formData.talentType === "actor" ? "default" : "outline"}
                 onClick={() => setFormData({ ...formData, talentType: "actor" })}
                 className="flex-1"
               >
                 <User className="h-4 w-4 mr-2" />
                 Acteur
               </Button>
             </div>
           </div>

           {/* Nom complet */}
           <div>
             <label htmlFor="name" className="text-sm font-medium">
               Nom complet <span className="text-destructive">*</span>
             </label>
             <input
               id="name"
               className="w-full px-3 py-2 border rounded-md mt-1"
               value={formData.name || ""}
               onChange={(e) => setFormData({ ...formData, name: e.target.value })}
               placeholder="Jean Dupont"
             />
           </div>

           {/* Nom de scène */}
           <div>
             <label htmlFor="stageName" className="text-sm font-medium">Nom de scène / Pseudo</label>
             <input
               id="stageName"
               className="w-full px-3 py-2 border rounded-md mt-1"
               value={formData.stageName || ""}
               onChange={(e) => setFormData({ ...formData, stageName: e.target.value })}
               placeholder="DJ Cool"
             />
           </div>
         </div>
       </AccordionContent>
     </Card>
   </AccordionItem>
   ```

3. **Accordion 2: Contact** (email, phone, website)
   ```typescript
   <AccordionItem value="contact">
     <Card>
       <AccordionTrigger className="px-4 py-3 hover:no-underline" onClick={handleAccordionTriggerClick}>
         <h3 className="text-lg font-semibold flex items-center gap-2">
           <Mail className="h-5 w-5 text-primary" />
           Contact
         </h3>
       </AccordionTrigger>
       <AccordionContent>
         <div className="px-4 pb-3 space-y-3">
           <div className="grid md:grid-cols-2 gap-3">
             <div>
               <label htmlFor="email" className="text-sm font-medium">Email</label>
               <input
                 id="email"
                 type="email"
                 className="w-full px-3 py-2 border rounded-md mt-1"
                 value={formData.email || ""}
                 onChange={(e) => setFormData({ ...formData, email: e.target.value })}
                 placeholder="jean@example.com"
               />
             </div>
             <div>
               <label htmlFor="phone" className="text-sm font-medium">Téléphone</label>
               <input
                 id="phone"
                 type="tel"
                 className="w-full px-3 py-2 border rounded-md mt-1"
                 value={formData.phone || ""}
                 onChange={(e) => setFormData({ ...formData, phone: e.target.value })}
                 placeholder="+33 6 12 34 56 78"
               />
             </div>
           </div>
           <div>
             <label htmlFor="website" className="text-sm font-medium">Site web</label>
             <input
               id="website"
               type="url"
               className="w-full px-3 py-2 border rounded-md mt-1"
               value={formData.website || ""}
               onChange={(e) => setFormData({ ...formData, website: e.target.value })}
               placeholder="https://example.com"
             />
           </div>
         </div>
       </AccordionContent>
     </Card>
   </AccordionItem>
   ```

4. **Accordion 3: Profil Musical** (instruments, genres, bio)
   ```typescript
   <AccordionItem value="profil-musical">
     <Card>
       <AccordionTrigger className="px-4 py-3 hover:no-underline" onClick={handleAccordionTriggerClick}>
         <h3 className="text-lg font-semibold flex items-center gap-2">
           <Music className="h-5 w-5 text-primary" />
           Profil Musical
         </h3>
       </AccordionTrigger>
       <AccordionContent>
         <div className="px-4 pb-3 space-y-3">
           <div className="grid md:grid-cols-2 gap-3">
             <div>
               <label htmlFor="instruments" className="text-sm font-medium">Instruments</label>
               <input
                 id="instruments"
                 className="w-full px-3 py-2 border rounded-md mt-1"
                 value={formData.instruments || ""}
                 onChange={(e) => setFormData({ ...formData, instruments: e.target.value })}
                 placeholder="Guitare, Piano, Batterie"
               />
               <p className="text-xs text-muted-foreground mt-1">Séparer par des virgules</p>
             </div>
             <div>
               <label htmlFor="genres" className="text-sm font-medium">Genres musicaux</label>
               <input
                 id="genres"
                 className="w-full px-3 py-2 border rounded-md mt-1"
                 value={formData.genres || ""}
                 onChange={(e) => setFormData({ ...formData, genres: e.target.value })}
                 placeholder="Rock, Jazz, Blues"
               />
               <p className="text-xs text-muted-foreground mt-1">Séparer par des virgules</p>
             </div>
           </div>
           <div>
             <label htmlFor="bio" className="text-sm font-medium">Biographie</label>
             <textarea
               id="bio"
               className="w-full px-3 py-2 border rounded-md mt-1 min-h-[100px]"
               value={formData.bio || ""}
               onChange={(e) => setFormData({ ...formData, bio: e.target.value })}
               placeholder="Parcours musical, expérience, style..."
             />
           </div>
         </div>
       </AccordionContent>
     </Card>
   </AccordionItem>
   ```

5. **Accordion 4: Plateformes Streaming** (Spotify, Apple Music, etc.)
   ```typescript
   <AccordionItem value="streaming">
     <Card>
       <AccordionTrigger className="px-4 py-3 hover:no-underline" onClick={handleAccordionTriggerClick}>
         <h3 className="text-lg font-semibold flex items-center gap-2">
           <Radio className="h-5 w-5 text-primary" />
           Plateformes Streaming
         </h3>
       </AccordionTrigger>
       <AccordionContent>
         <div className="px-4 pb-3 space-y-3">
           <div>
             <label htmlFor="spotifyUrl" className="text-sm font-medium">Spotify</label>
             <input
               id="spotifyUrl"
               type="url"
               className="w-full px-3 py-2 border rounded-md mt-1"
               value={formData.spotifyUrl || ""}
               onChange={(e) => setFormData({ ...formData, spotifyUrl: e.target.value })}
               placeholder="https://open.spotify.com/artist/..."
             />
           </div>
           {/* Add more streaming platforms if needed: appleMusicUrl, soundcloudUrl, etc. */}
         </div>
       </AccordionContent>
     </Card>
   </AccordionItem>
   ```

6. **Accordion 5: Notes** (internal notes)
   ```typescript
   <AccordionItem value="notes">
     <Card>
       <AccordionTrigger className="px-4 py-3 hover:no-underline" onClick={handleAccordionTriggerClick}>
         <h3 className="text-lg font-semibold flex items-center gap-2">
           <FileText className="h-5 w-5 text-primary" />
           Notes internes
         </h3>
       </AccordionTrigger>
       <AccordionContent>
         <div className="px-4 pb-3 space-y-3">
           <div>
             <label htmlFor="notes" className="text-sm font-medium">Notes</label>
             <textarea
               id="notes"
               className="w-full px-3 py-2 border rounded-md mt-1 min-h-[100px]"
               value={formData.notes || ""}
               onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
               placeholder="Notes internes du studio..."
             />
           </div>
         </div>
       </AccordionContent>
     </Card>
   </AccordionItem>
   ```

**Key differences from ClientEditForm:**
- Only 5 accordions (no addresses, company fields, structured name)
- Simpler field structure (talents have less metadata than clients)
- No conditional rendering by type (all talents use same form)
- Focus on music-specific fields (instruments, genres, streaming)

**Why accordion pattern:** Eliminates wizard navigation overhead, all fields accessible, matches Phase 26 client improvements
  </action>
  <verify>
1. Component exports TalentEditForm
2. TypeScript 0 errors on component definition
3. All 5 accordions render correctly
4. localStorage persistence works (talentEditAccordions key)
5. Alt+Click toggles all accordions
6. Form fields update formData correctly
  </verify>
  <done>
- TalentEditForm.tsx created with 5 accordions
- Identité, Contact, Profil Musical, Streaming, Notes sections
- All accordions open by default
- localStorage persistence for accordion state
- Alt+Click toggle all feature
- TypeScript compiles without errors
  </done>
</task>

<task type="auto">
  <name>Task 2: Integrate TalentEditForm into TalentDetailTabs</name>
  <files>packages/client/src/components/TalentDetailTabs.tsx</files>
  <action>
**Replace edit mode placeholder with TalentEditForm:**

1. **Import TalentEditForm:**
   ```typescript
   import { TalentEditForm } from "./TalentEditForm";
   ```

2. **Replace edit mode placeholder in Informations tab:**
   ```typescript
   {/* Edit Mode */}
   {isEditing && (
     <TalentEditForm
       formData={formData}
       setFormData={setFormData}
     />
   )}
   ```

3. **Ensure formData includes all talent fields** (name, stageName, email, phone, website, talentType, instruments, genres, bio, spotifyUrl, notes)

**Result:** Edit mode now uses accordion pattern instead of inline form or wizard
  </action>
  <verify>
1. Navigate to /talents/:id
2. Click "Modifier" button
3. TalentEditForm renders with 5 accordions
4. Edit fields update formData state
5. Click "Enregistrer" - mutation sends updated data
6. Click "Annuler" - returns to view mode
  </verify>
  <done>
- TalentDetailTabs imports TalentEditForm
- Edit mode renders accordion form
- View/edit toggle working correctly
- Form state synchronization functional
- TypeScript 0 errors
  </done>
</task>

<task type="auto">
  <name>Task 3: Refactor TalentCreate.tsx to use TalentEditForm</name>
  <files>packages/client/src/pages/TalentCreate.tsx</files>
  <action>
**Pattern reference:** ClientCreate.tsx after Phase 22 refactor - reusable form component

**Simplify creation page:**

1. **Import TalentEditForm:**
   ```typescript
   import { TalentEditForm } from "@/components/TalentEditForm";
   ```

2. **Keep formData state and createMutation** (existing logic is good)

3. **Replace inline form with TalentEditForm:**
   ```typescript
   return (
     <div className="container pt-2 pb-4 px-2">
       <div className="space-y-2">
         {/* Header */}
         <div className="flex items-center justify-between">
           <div className="flex items-center gap-4">
             <Link to="/talents">
               <Button variant="ghost" size="icon">
                 <ArrowLeft className="h-5 w-5" />
               </Button>
             </Link>
             <div>
               <h1 className="text-3xl font-bold flex items-center gap-2">
                 <Music className="h-8 w-8 text-primary" />
                 Nouveau Talent
               </h1>
             </div>
           </div>
         </div>

         {/* Form */}
         <form onSubmit={handleSubmit}>
           <TalentEditForm
             formData={formData}
             setFormData={setFormData}
           />

           {/* Submit button */}
           <div className="mt-4 flex justify-end gap-2">
             <Button type="button" variant="outline" asChild>
               <Link to="/talents">
                 <X className="h-4 w-4 mr-2" />
                 Annuler
               </Link>
             </Button>
             <Button type="submit" disabled={createMutation.isPending}>
               <Save className="h-4 w-4 mr-2" />
               Créer le talent
             </Button>
           </div>
         </form>
       </div>
     </div>
   );
   ```

4. **Remove all inline form inputs** (lines ~88-300+ in current file - replaced by TalentEditForm)

**Result:** TalentCreate.tsx reduces from ~250 lines to ~100 lines, reuses TalentEditForm component

**Benefits:**
- DRY principle (single form component for create + edit)
- Consistency (same UI for creation and editing)
- Maintainability (form changes only in TalentEditForm.tsx)
  </action>
  <verify>
1. Navigate to /talents/new
2. TalentEditForm renders with 5 accordions
3. Fill form fields (name required, others optional)
4. Click "Créer le talent" - createMutation fires
5. Successful creation redirects to detail page
6. TypeScript 0 errors
  </verify>
  <done>
- TalentCreate.tsx refactored to use TalentEditForm
- Page simplified to ~100 lines (from ~250)
- Reusable form component for create + edit
- Submit button with validation
- TypeScript compiles successfully
  </done>
</task>

<task type="auto">
  <name>Task 4: Build and verify harmonization complete</name>
  <files>packages/client/src/components/TalentEditForm.tsx, packages/client/src/components/TalentDetailTabs.tsx, packages/client/src/pages/TalentCreate.tsx</files>
  <action>
**Final verification steps:**

1. **TypeScript check:**
   ```bash
   pnpm --filter client check
   ```

2. **Build test:**
   ```bash
   pnpm --filter client build
   ```

3. **Test complete workflow:**
   - Visit /talents/new → create talent with TalentEditForm
   - Visit /talents/:id → view talent detail with tabs
   - Click "Modifier" → edit mode uses TalentEditForm accordions
   - Click "Enregistrer" → updates persist
   - Visit /talents → list view with Table/Grid/Kanban modes (28-03)

4. **Document completion in commit:**
   ```bash
   git add packages/client/src/components/TalentEditForm.tsx packages/client/src/components/TalentDetailTabs.tsx packages/client/src/pages/TalentCreate.tsx
   git commit -m "feat(28-05): replace wizard with accordion-based TalentEditForm

Phase 28 Gap Closure Plan 05: TalentEditForm Harmonization
- Created TalentEditForm component (5 accordions: Identité, Contact, Profil Musical, Streaming, Notes)
- Integrated into TalentDetailTabs edit mode (replaces inline form)
- Refactored TalentCreate.tsx to use TalentEditForm (~100 lines from ~250)
- Wizard pattern eliminated completely
- All accordions open by default (Alt+Click toggle all)
- localStorage persistence for accordion state

Gap addressed: Formulaire édition talent harmonisé avec ClientEditForm Phase 26
Pattern reference: Accordion-based edit form, reusable component, DRY principle

Phase 28 COMPLETE: Talents UI fully harmonized with Clients
- 28-01: Enhanced backend (search, sort, stats)
- 28-02: ViewMode toggle, stats cards, components
- 28-03: Table/Grid/Kanban views implemented
- 28-04: TalentDetail tabbed interface
- 28-05: TalentEditForm accordion pattern

Co-Authored-By: Claude Sonnet 4.5 <noreply@anthropic.com>"
   ```

**Success indicators:**
- ✓ Build successful (zero errors)
- ✓ TypeScript passes
- ✓ Create/edit/view workflows functional
- ✓ Wizard eliminated, accordion pattern adopted
- ✓ Phase 28 complete
  </action>
  <verify>
1. TypeScript check passes (0 errors)
2. Build completes successfully
3. No console errors in create/edit/view workflows
4. All 5 accordions functional
5. Form state synchronization working
6. Git commit created with Phase 28 completion message
  </verify>
  <done>
- TypeScript 0 errors confirmed
- Production build successful
- TalentEditForm harmonized with ClientEditForm patterns
- Wizard pattern eliminated (Phase 26 goal achieved)
- Phase 28 gap closure complete
- All talents UI harmonized with clients (Phases 22-27)
  </done>
</task>

</tasks>

<verification>
**Phase 28 Complete Verification:**

1. **List page (28-01, 28-02, 28-03):**
   - [x] Table view with sortable columns
   - [x] Grid view with avatars
   - [x] Kanban view by talent type
   - [x] Stats cards, ViewMode toggle
   - [x] Copy buttons, search/filter

2. **Detail page (28-04):**
   - [x] Tabbed interface (Informations, Sessions, Projets, Finances)
   - [x] View mode organized sections
   - [x] Edit/Save/Cancel button workflow

3. **Edit form (28-05):**
   - [x] Accordion-based pattern
   - [x] 5 accordions (Identité, Contact, Profil Musical, Streaming, Notes)
   - [x] All open by default
   - [x] Reusable in create/edit modes
   - [x] Wizard eliminated

**Gap closure verification:**
- [x] Gap 1: TalentDetail harmonized with ClientDetail (28-04)
- [x] Gap 2: TalentEditForm harmonized with ClientEditForm (28-05)
- [x] All Phase 28 plans complete (28-01 through 28-05)
</verification>

<success_criteria>
- [ ] TalentEditForm component created with 5 accordions
- [ ] All accordions open by default with localStorage persistence
- [ ] Alt+Click toggles all accordions
- [ ] TalentDetailTabs integrates TalentEditForm in edit mode
- [ ] TalentCreate.tsx refactored to use TalentEditForm (~100 lines)
- [ ] Wizard pattern eliminated from creation flow
- [ ] TypeScript 0 errors
- [ ] Client builds successfully
- [ ] Create/edit/view workflows all functional
- [ ] Gap addressed: Formulaire édition harmonisé avec Phase 26 patterns
- [ ] Phase 28 complete: All talents UI harmonized with clients
</success_criteria>

<output>
After completion, create `.planning/phases/28-harmonisation-ui-talents/28-05-SUMMARY.md`
</output>
