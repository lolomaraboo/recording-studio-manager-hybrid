---
phase: 3.5-password-confirmation-field
plan: 01
type: execute
---

<objective>
Add password confirmation field to registration page for improved UX and error prevention.

Purpose: Prevent user typos during registration by requiring password to be entered twice and validated for match before submission. Standard UX best practice for account creation forms.

Output: Updated Register.tsx component with password confirmation field, client-side validation, and user-friendly error messaging.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@packages/client/src/pages/Register.tsx

**Current State:**
- Registration form has 4 fields: Full Name, Email, Password, Studio Name
- Password field has HTML5 validation (required, minLength=8)
- No confirmation field currently exists

**UX Improvement Goal:**
- Add "Confirm Password" field after Password field
- Validate passwords match before allowing submission
- Show clear error message if passwords don't match
- Maintain existing styling and form flow
</context>

<tasks>

<task type="auto">
  <name>Add password confirmation field to Register component</name>
  <files>packages/client/src/pages/Register.tsx</files>
  <action>
1. Add `confirmPassword` state variable after the `password` state declaration
2. Add new form field between Password field (lines 78-90) and Studio Name field (lines 91-102):
   - Label: "Confirm Password"
   - Input id: "confirmPassword"
   - Input type: "password"
   - Placeholder: "••••••••"
   - Required attribute
   - minLength={8} to match password field
   - Disabled when isSubmitting
   - Value bound to confirmPassword state
   - onChange handler to update confirmPassword state
3. Add client-side validation in handleSubmit (line 19-33):
   - Before calling register(), check if password !== confirmPassword
   - If mismatch, show toast.error("Passwords don't match") and return early
   - Don't call setIsSubmitting(true) if validation fails
4. Follow exact styling pattern from existing password field (space-y-2 wrapper, same Input component props)
5. Maintain accessibility with proper htmlFor label association
  </action>
  <verify>
- npm run build succeeds without TypeScript errors
- Register page loads at /register without console errors
- Confirm Password field appears between Password and Studio Name fields
- Field is styled consistently with other inputs
- Field shows placeholder text and has required attribute
  </verify>
  <done>
- confirmPassword state variable added
- Confirm Password field renders in correct position with proper styling
- Field is bound to state with onChange handler
- Field has same validation attributes as Password field (required, minLength=8)
- TypeScript compiles without errors
  </done>
</task>

<task type="auto">
  <name>Add password match validation logic</name>
  <files>packages/client/src/pages/Register.tsx</files>
  <action>
In handleSubmit function (currently lines 19-33), add validation logic at the start:
1. After e.preventDefault(), before setIsSubmitting(true)
2. Add check: if (password !== confirmPassword)
3. Show user-friendly error: toast.error("Passwords don't match. Please try again.")
4. Return early without calling setIsSubmitting(true) or register()
5. This prevents form submission if passwords mismatch
6. Existing try-catch error handling remains unchanged
  </action>
  <verify>
Test scenarios:
- Enter matching passwords → form submits successfully
- Enter mismatching passwords → toast error appears, form doesn't submit
- Fix mismatch and resubmit → form submits successfully
- All existing form validation still works (required fields, email format, minLength)
  </verify>
  <done>
- Password mismatch validation added to handleSubmit
- toast.error displays when passwords don't match
- Form submission blocked on password mismatch
- Early return prevents unnecessary API call
- No regression in existing validation behavior
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Password confirmation field on registration page with client-side validation</what-built>
  <how-to-verify>
1. Run: cd packages/client && npm run dev
2. Visit: http://localhost:5173/register (or production URL)
3. Test Case 1 - Passwords Match:
   - Fill in: Name, Email, Password (e.g., "password123"), Confirm Password ("password123"), Studio Name
   - Click "Create Account"
   - Expected: Registration succeeds, redirects to dashboard, shows success toast
4. Test Case 2 - Passwords Don't Match:
   - Fill in: Name, Email, Password ("password123"), Confirm Password ("different123"), Studio Name
   - Click "Create Account"
   - Expected: Error toast appears "Passwords don't match", form doesn't submit, stays on register page
5. Test Case 3 - Visual Check:
   - Confirm Password field appears between Password and Studio Name
   - Field styling matches other inputs (same height, padding, border)
   - Label "Confirm Password" is properly aligned
   - Placeholder shows "••••••••" correctly
6. Test Case 4 - Fix Mismatch:
   - After Test Case 2 error, correct Confirm Password to match
   - Resubmit form
   - Expected: Registration succeeds
  </how-to-verify>
  <resume-signal>Type "approved" if all tests pass, or describe any issues found</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] `npm run build` succeeds without errors
- [ ] Register page loads without console errors
- [ ] Confirm Password field renders in correct position
- [ ] Password mismatch validation works (shows error toast, blocks submission)
- [ ] Password match validation works (allows successful registration)
- [ ] Field styling is consistent with existing inputs
- [ ] No regression in existing form functionality (email validation, minLength, required fields)
</verification>

<success_criteria>
- Password confirmation field added to registration form
- Client-side validation prevents mismatched passwords from being submitted
- User receives clear error message when passwords don't match
- Form submission works correctly when passwords match
- No visual or functional regression in existing registration flow
- TypeScript compiles without errors
- All manual verification tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/3.5-password-confirmation-field/3.5-01-SUMMARY.md`:

# Phase 3.5 Plan 1: Password Confirmation Field Summary

**Added password confirmation field to registration page with client-side validation**

## Accomplishments

- Added confirmPassword state variable to Register component
- Inserted Confirm Password input field between Password and Studio Name fields
- Implemented password match validation in handleSubmit function
- Added user-friendly error toast when passwords don't match
- Maintained consistent styling and UX with existing form fields

## Files Created/Modified

- `packages/client/src/pages/Register.tsx` - Added confirmPassword state, form field, and validation logic

## Decisions Made

- Client-side validation only (backend already validates password format via zod schema)
- Toast error message for password mismatch (consistent with existing error handling pattern)
- Field positioned between Password and Studio Name (logical flow for password re-entry)
- Early return on validation failure (prevents unnecessary state changes and API calls)

## Issues Encountered

[Document any issues encountered during implementation, or "None"]

## Next Phase Readiness

Phase 4 (Marketing Foundation) is ready to begin. This UX improvement ensures new signups have better password entry experience before marketing launch drives increased traffic.
</output>
